
# 圖書排名資料清洗作業流程

本專案目的是清洗與處理圖書銷售排名資料，並計算各書籍之統計指標，流程分為三個主要步驟，對應三支 Python 程式：

## 流程概述

1. **初步正規化與篩選（`check_rank.py`）**  
   - 將原始 `ranking.csv` 資料進行初步正規化處理。
   - 依照指定日期範圍篩選出符合條件的書籍排名紀錄。
   - 拆解 ranking 欄位，萃取出榜單名稱（chart）、日期（date）、名次（rank number）。
   - 將篩選後的排名資料與 `bookdetail.csv` 書籍資料合併。
   - 匯出整理後的排名明細檔案（格式範例：`20241001_20241231_detail_ranking.csv`）。
   - 若有格式異常資料，另存錯誤清單。

2. **統計指標計算與整理（`wash.py`）**  
   - 載入第一步輸出的整理後資料與書籍明細。
   - 計算每本書籍的各項統計指標，包括：
     - 名次統計（最佳、最差、平均、中位數、眾數、標準差）
     - 上榜天數（上榜次數、最長連續上榜日數、覆蓋率）
     - 變異係數（CV）、偏態係數（Skewness）、四分位距（IQR）
     - 平均名次的 Z-score
   - 將統計結果與基本書籍資料合併。
   - 匯出最終統計結果檔案（檔名含時間戳記，如：`bookstats_2024Q4_YYYYMMDD_HHMMSS.csv`）。

3. **缺值檢查與清單匯出（`value_append.py`）**  
   - 檢查統計資料中的關鍵欄位（如 ISBN、作者、出版社等）是否有缺漏。
   - 比對 `bookdetail.csv`，確認是否可從明細補齊資料。
   - 輸出缺值書目清單，供後續資料修正參考。

---

## 執行順序

1. 執行 `check_rank.py` → 輸出整理後排名檔案
2. 執行 `wash.py` → 輸出書籍統計結果檔案
3. 執行 `value_append.py` → 確認資料缺值狀態

---
